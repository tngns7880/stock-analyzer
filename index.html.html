<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì£¼ì‹ íˆ¬ì ë¶„ì„ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PWAë¥¼ ìœ„í•œ ì„¤ì • -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4f46e5"/>
    <link rel="apple-touch-icon" href="https://placehold.co/192x192/4f46e5/ffffff?text=AI">


    <style>
        body { font-family: 'Inter', sans-serif; }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #4f46e5;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="container mx-auto p-4 max-w-lg w-full">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8">
            <header class="text-center mb-6">
                <h1 class="text-3xl font-bold text-gray-900">AI ì£¼ì‹ íˆ¬ì ë¶„ì„ê¸°</h1>
                <p class="text-gray-500 mt-2">ë„¤ì´ë²„ ì¦ê¶Œ ì •ë³´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ íˆ¬ì ë°©í–¥ì„±ì„ ë¶„ì„í•©ë‹ˆë‹¤.</p>
            </header>

            <!-- ì¢…ëª© ì…ë ¥ -->
            <div class="mb-4">
                <label for="stockName" class="block text-sm font-medium text-gray-700 mb-1">ì¢…ëª©ëª… ë˜ëŠ” ì¢…ëª©ì½”ë“œ</label>
                <input type="text" id="stockName" class="w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="ì˜ˆ: ì‚¼ì„±ì „ì ë˜ëŠ” 005930">
            </div>

            <!-- ë¶„ì„ ë²„íŠ¼ -->
            <div class="text-center mb-6">
                <button id="analyzeBtn" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition duration-300 shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    AI ë¶„ì„ ì‹œì‘
                </button>
            </div>
            
            <!-- ë¶„ì„ ê²°ê³¼ -->
            <div id="resultSection" class="hidden">
                <!-- ë¡œë”© ìŠ¤í”¼ë„ˆ -->
                <div id="loading" class="flex flex-col items-center justify-center py-8 hidden">
                    <div class="spinner mb-4"></div>
                    <p class="text-gray-600">AIê°€ <span id="loadingStockName" class="font-bold"></span> ì¢…ëª©ì„ ë¶„ì„ì¤‘ì…ë‹ˆë‹¤...</p>
                </div>

                <!-- ê²°ê³¼ ë””ìŠ¤í”Œë ˆì´ -->
                <div id="resultContent" class="hidden">
                    <h2 class="text-2xl font-bold text-center mb-4"><span id="resultStockName" class="text-indigo-600"></span> ë¶„ì„ ê²°ê³¼</h2>
                    <div id="resultCard" class="p-6 rounded-lg border-2">
                        <p class="text-center text-xl font-semibold mb-2" id="resultOpinion"></p>
                        <p class="text-center text-gray-600 text-sm mb-4" id="resultScore"></p>
                        <div class="space-y-3 text-sm">
                           <p id="summaryProfit"></p>
                           <p id="summaryStability"></p>
                           <p id="summaryGrowth"></p>
                           <p id="summaryValuation"></p>
                        </div>
                    </div>
                    <div class="text-center mt-4">
                         <a id="naverLink" href="https://finance.naver.com/" target="_blank" class="text-indigo-600 hover:underline text-sm font-semibold">ë„¤ì´ë²„ ì¦ê¶Œì—ì„œ ì§ì ‘ í™•ì¸ &rarr;</a>
                    </div>
                </div>
            </div>

             <!-- ì£¼ì˜ì‚¬í•­ -->
            <div class="mt-6 text-xs text-gray-400 text-center">
                <p>âš ï¸ ë³¸ ë¶„ì„ì€ ì¼ë°˜ì ì¸ íˆ¬ì ì§€í‘œë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹œë®¬ë ˆì´ì…˜ì´ë©°, ì‹¤ì œ ë°ì´í„°ì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íˆ¬ì ê²°ì •ì˜ ìµœì¢… ì±…ì„ì€ íˆ¬ìì ë³¸ì¸ì—ê²Œ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <script>
        // PWA ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }

        const analyzeBtn = document.getElementById('analyzeBtn');
        const resultSection = document.getElementById('resultSection');
        const loading = document.getElementById('loading');
        const resultContent = document.getElementById('resultContent');
        const stockNameInput = document.getElementById('stockName');

        analyzeBtn.addEventListener('click', () => {
            const stockName = stockNameInput.value;
            if (!stockName) {
                alert('ì¢…ëª©ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // UI ì´ˆê¸°í™” ë° ë¡œë”© ì‹œì‘
            resultSection.classList.remove('hidden');
            resultContent.classList.add('hidden');
            loading.classList.remove('hidden');
            document.getElementById('loadingStockName').textContent = stockName;
            
            // AI ë¶„ì„ ì‹œë®¬ë ˆì´ì…˜ (2.5ì´ˆ)
            setTimeout(() => {
                const mockData = generateMockData();
                const analysisResult = analyzeData(mockData);
                displayResults(stockName, analysisResult);

                loading.classList.add('hidden');
                resultContent.classList.remove('hidden');
            }, 2500);
        });

        function generateMockData() {
            // ë„¤ì´ë²„ ì¦ê¶Œì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ì§€í‘œë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ëœë¤ ë°ì´í„° ìƒì„±
            return {
                roe: (Math.random() * 35 - 10).toFixed(2), // -10% ~ 25%
                debtRatio: (Math.random() * 250).toFixed(2), // 0% ~ 250%
                salesGrowth: (Math.random() * 40 - 5).toFixed(2), // -5% ~ 35%
                per: (Math.random() * 45 + 5).toFixed(2), // 5 ~ 50
                pbr: (Math.random() * 4.5 + 0.5).toFixed(2), // 0.5 ~ 5
            };
        }

        function analyzeData(data) {
            let score = 0;
            const comments = {
                profit: '',
                stability: '',
                growth: '',
                valuation: ''
            };

            // 1. ìˆ˜ìµì„± (ROE)
            if (data.roe > 15) { score += 30; comments.profit = `ğŸŸ¢ **ìˆ˜ìµì„±:** ROE ${data.roe}%ë¡œ ìê¸°ìë³¸ì„ ë§¤ìš° íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•˜ì—¬ ë†’ì€ ìˆ˜ìµì„ ë‚´ê³  ìˆìŠµë‹ˆë‹¤.`; }
            else if (data.roe > 5) { score += 15; comments.profit = `ğŸŸ¡ **ìˆ˜ìµì„±:** ROE ${data.roe}%ë¡œ ì–‘í˜¸í•œ ìˆ˜ìµì„±ì„ ë³´ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤.`; }
            else { score += 5; comments.profit = `ğŸ”´ **ìˆ˜ìµì„±:** ROE ${data.roe}%ë¡œ ìˆ˜ìµì„± ê°œì„ ì´ í•„ìš”í•œ ìƒí™©ì…ë‹ˆë‹¤.`; }

            // 2. ì•ˆì •ì„± (ë¶€ì±„ë¹„ìœ¨)
            if (data.debtRatio < 100) { score += 30; comments.stability = `ğŸŸ¢ **ì•ˆì •ì„±:** ë¶€ì±„ë¹„ìœ¨ì´ ${data.debtRatio}%ë¡œ ë§¤ìš° ë‚®ì•„ ì¬ë¬´ì ìœ¼ë¡œ ì•ˆì •ì ì…ë‹ˆë‹¤.`; }
            else if (data.debtRatio < 200) { score += 15; comments.stability = `ğŸŸ¡ **ì•ˆì •ì„±:** ë¶€ì±„ë¹„ìœ¨ ${data.debtRatio}%ë¡œ ì–‘í˜¸í•œ ìˆ˜ì¤€ì´ë‚˜, ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.`; }
            else { score += 5; comments.stability = `ğŸ”´ **ì•ˆì •ì„±:** ë¶€ì±„ë¹„ìœ¨ì´ ${data.debtRatio}%ë¡œ ë†’ì•„ ì¬ë¬´ì  ìœ„í—˜ì„±ì„ ì ê²€í•´ì•¼ í•©ë‹ˆë‹¤.`; }

            // 3. ì„±ì¥ì„± (ë§¤ì¶œì•¡ ì¦ê°€ìœ¨)
            if (data.salesGrowth > 10) { score += 20; comments.growth = `ğŸŸ¢ **ì„±ì¥ì„±:** ë§¤ì¶œì´ ì „ë…„ ëŒ€ë¹„ ${data.salesGrowth}% ì¦ê°€í•˜ì—¬ ë†’ì€ ì„±ì¥ì„¸ë¥¼ ë³´ì…ë‹ˆë‹¤.`; }
            else if (data.salesGrowth > 0) { score += 10; comments.growth = `ğŸŸ¡ **ì„±ì¥ì„±:** ë§¤ì¶œì´ ${data.salesGrowth}% ì¦ê°€í•˜ë©° ê¾¸ì¤€í•œ ì„±ì¥ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.`; }
            else { score += 0; comments.growth = `ğŸ”´ **ì„±ì¥ì„±:** ë§¤ì¶œì´ ${data.salesGrowth}% ê°ì†Œí•˜ì—¬ ì„±ì¥ ë™ë ¥ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.`; }
            
            // 4. ê°€ì¹˜ (PER, PBR)
            const valuationScore = (1 / data.per) * 100 + (1 / data.pbr) * 10;
            if (valuationScore > 15) { score += 20; comments.valuation = `ğŸŸ¢ **ê°€ì¹˜:** PER ${data.per}, PBR ${data.pbr}ë¡œ ì—…ì¢… ëŒ€ë¹„ ì €í‰ê°€ ë§¤ë ¥ì´ ìˆìŠµë‹ˆë‹¤.`; }
            else if (valuationScore > 8) { score += 10; comments.valuation = `ğŸŸ¡ **ê°€ì¹˜:** PER ${data.per}, PBR ${data.pbr}ë¡œ ì ì • ì£¼ê°€ ìˆ˜ì¤€ìœ¼ë¡œ í‰ê°€ë©ë‹ˆë‹¤.`; }
            else { score += 0; comments.valuation = `ğŸ”´ **ê°€ì¹˜:** PER ${data.per}, PBR ${data.pbr}ë¡œ ë‹¤ì†Œ ê³ í‰ê°€ ìƒíƒœì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`; }

            let opinion = '';
            let cardClass = '';
            if (score >= 70) {
                opinion = 'ê¸ì •ì  íˆ¬ì ê²€í† ';
                cardClass = 'bg-green-50 border-green-500';
            } else if (score >= 40) {
                opinion = 'ì‹ ì¤‘í•œ ì ‘ê·¼ í•„ìš”';
                cardClass = 'bg-yellow-50 border-yellow-500';
            } else {
                opinion = 'íˆ¬ì ìœ„í—˜ì„± ë†’ìŒ';
                cardClass = 'bg-red-50 border-red-500';
            }

            return { score, opinion, comments, cardClass };
        }

        function displayResults(stockName, result) {
            document.getElementById('resultStockName').textContent = stockName;
            document.getElementById('resultOpinion').textContent = result.opinion;
            document.getElementById('resultScore').textContent = `AI ì¢…í•©ì ìˆ˜: ${result.score} / 100`;
            
            document.getElementById('summaryProfit').innerHTML = result.comments.profit;
            document.getElementById('summaryStability').innerHTML = result.comments.stability;
            document.getElementById('summaryGrowth').innerHTML = result.comments.growth;
            document.getElementById('summaryValuation').innerHTML = result.comments.valuation;

            const resultCard = document.getElementById('resultCard');
            resultCard.className = `p-6 rounded-lg border-2 ${result.cardClass}`;
            
            const naverLink = document.getElementById('naverLink');
            naverLink.href = `https://finance.naver.com/item/main.naver?code=${stockName.match(/\d{6}/) ? stockName : ''}`;
        }
    </script>
</body>
</html>

